<Page
    x:Class="Subsonic8.Phone.Views.PlaybackPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- Fade Out Animation -->
        <Storyboard x:Name="FadeOutStoryboard">
            <DoubleAnimation 
                Storyboard.TargetName="SongInfoPanel"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.15"/>
            <DoubleAnimation 
                Storyboard.TargetName="AlbumArtBorder"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Fade In Animation -->
        <Storyboard x:Name="FadeInStoryboard">
            <DoubleAnimation 
                Storyboard.TargetName="SongInfoPanel"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.25"/>
            <DoubleAnimation 
                Storyboard.TargetName="AlbumArtBorder"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.25"/>
        </Storyboard>
        
        <!-- Background Crossfade -->
        <Storyboard x:Name="BackgroundFadeStoryboard">
            <DoubleAnimation 
                Storyboard.TargetName="BackgroundImage"
                Storyboard.TargetProperty="Opacity"
                From="0.3" To="0.6" Duration="0:0:0.4"/>
        </Storyboard>
    </Page.Resources>

    <Grid Background="Black">
        <!-- Full Screen Album Art Background -->
        <Image x:Name="BackgroundImage" 
               Stretch="UniformToFill" 
               Opacity="0.6"/>

        <!-- Gradient Overlay -->
        <Rectangle>
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#66000000" Offset="0"/>
                    <GradientStop Color="#00000000" Offset="0.3"/>
                    <GradientStop Color="#00000000" Offset="0.6"/>
                    <GradientStop Color="#CC000000" Offset="1"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>

        <!-- Main Content -->
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Album Art & Song Info Row -->
            <Grid Grid.Row="0" VerticalAlignment="Bottom" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Album Art Card (with animation target name) -->
                <Border x:Name="AlbumArtBorder"
                        Grid.Column="0" 
                        VerticalAlignment="Bottom"
                        MaxHeight="150"
                        MaxWidth="150"
                        Background="#33FFFFFF">
                    <Image x:Name="AlbumArtImage" 
                           Stretch="Uniform"/>
                </Border>

                <!-- Song Info (Right of Album Art) -->
                <StackPanel x:Name="SongInfoPanel"
                            Grid.Column="1" 
                            VerticalAlignment="Bottom" 
                            Margin="16,0,0,0">
                    <TextBlock x:Name="SongTitleText"
                               Text="Song Title"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="White"
                               TextWrapping="Wrap"
                               MaxLines="2"/>
                    <TextBlock x:Name="ArtistText"
                               Text="Artist Name"
                               FontSize="18"
                               Foreground="#CCFFFFFF"
                               Margin="0,4,0,0"/>
                </StackPanel>
            </Grid>

            <!-- Progress Bar area -->
            <Grid Grid.Row="1" Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="CurrentTimeText" 
                           Text="0:00" 
                           Foreground="White"
                           FontSize="14"
                           VerticalAlignment="Center"/>

                <Slider x:Name="ProgressSlider"
                        Grid.Column="1"
                        Margin="12,0"
                        ValueChanged="OnProgressSliderChanged"
                        Foreground="{ThemeResource PhoneAccentBrush}"
                        Background="#66FFFFFF"/>

                <TextBlock x:Name="TotalTimeText" 
                           Text="0:00" 
                           Foreground="White"
                           FontSize="14"
                           VerticalAlignment="Center"
                           Grid.Column="2"/>
            </Grid>

            <!-- Playback Controls -->
            <Grid Grid.Row="2" Margin="0,0,0,36">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Previous -->
                <Button Grid.Column="0"
                        Style="{StaticResource CircularButtonStyle}"
                        Width="60" Height="60"
                        HorizontalAlignment="Right"
                        Margin="0,0,24,0"
                        Click="OnPreviousClick">
                    <TextBlock Text="&#xE100;" 
                               FontFamily="Segoe UI Symbol" 
                               FontSize="24"/>
                </Button>

                <!-- Play/Pause (Large) -->
                <Button x:Name="PlayPauseButton"
                        Grid.Column="1"
                        Style="{StaticResource CircularButtonStyle}"
                        Width="80" Height="80"
                        Click="OnPlayPauseClick">
                    <TextBlock Text="&#xE102;" 
                               FontFamily="Segoe UI Symbol" 
                               FontSize="32"
                               Margin="4,0,0,0"/>
                </Button>

                <!-- Next -->
                <Button Grid.Column="2"
                        Style="{StaticResource CircularButtonStyle}"
                        Width="60" Height="60"
                        HorizontalAlignment="Left"
                        Margin="24,0,0,0"
                        Click="OnNextClick">
                    <TextBlock Text="&#xE101;" 
                               FontFamily="Segoe UI Symbol" 
                               FontSize="24"/>
                </Button>
            </Grid>
        </Grid>

        <!-- MediaElement removed for Background Audio integration -->
    </Grid>
</Page>
